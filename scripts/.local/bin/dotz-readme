#!/bin/sh
#
# dotz-readme - 0.0.1 - May 29, 2019 @  7:34 am
# created: May 29, 2019 @  7:34 am by Cory G
# license: gpl-2.0
#
#       ██            ██                                              ██
#      ░██           ░██                                             ░██
#      ░██  ██████  ██████ ██████       ██████  █████   ██████       ░██
#   ██████ ██░░░░██░░░██░ ░░░░██  █████░░██░░█ ██░░░██ ░░░░░░██   ██████
#  ██░░░██░██   ░██  ░██     ██  ░░░░░  ░██ ░ ░███████  ███████  ██░░░██
# ░██  ░██░██   ░██  ░██    ██          ░██   ░██░░░░  ██░░░░██ ░██  ░██
# ░░██████░░██████   ░░██  ██████      ░███   ░░██████░░████████░░██████
#  ░░░░░░  ░░░░░░     ░░  ░░░░░░       ░░░     ░░░░░░  ░░░░░░░░  ░░░░░░
#
#
#  ██████████   █████
# ░░██░░██░░██ ██░░░██
#  ░██ ░██ ░██░███████
#  ░██ ░██ ░██░██░░░░
#  ███ ░██ ░██░░██████
# ░░░  ░░  ░░  ░░░░░░
#
# *******************************
# A script I've stupidly left with the default description and vaguely named dotz-readme
# ------------------------------------------
#
# contact
# -------
# << cory.gantenbein@protonmail.com >> || << https://coryg.me >>

echo "Generating README.md"

TMP_FILE="./tmp.txt"
RDMEFILE=$DOTSDIR/README.md
APPS_FILE="Packages.md"
RDME_DIR=$DOTSDIR/dotz.d
OS_STRING=$(neofetch --stdout | grep "OS")
OS_NAME=${OS_STRING#"OS: "}

rm $RDMEFILE

RDME_TITLE="# $OS_NAME.dotfiles

![Screenshot](scrot.png)"

neofetch --stdout --disable title underline model kernel uptime packages resolution cpu gpu memory >> $TMP_FILE
sed -i '/^$/d' $TMP_FILE
sed -i -e 's/^/- /' $TMP_FILE
NEOFETCH="$(cat $TMP_FILE)"
LSBLK="$(mdlsblk)"

RDME_INTRO="$(cat $RDME_DIR/readme_intro.md)"
RDME_NOTES="$(cat $RDME_DIR/readme_notes.md)"
RDME_PACKZ="$(cat $RDME_DIR/readme_packz.md)"

PKGZ_LIST="#### Packages
$RDME_PACKZ [here](https://github.com/cory-g/dots/tree/master/docs/$APPS_FILE)."

function echo_it () {
  if [ -f "$RDMEFILE" ]; then
    echo "$1" >> $RDMEFILE
    echo "" >> $RDMEFILE
  else
    echo "$1" > $RDMEFILE
    echo "" >> $RDMEFILE
  fi
}

echo_it "$RDME_TITLE"
echo_it "$RDME_INTRO"
echo_it "### Basics"
echo_it "$NEOFETCH"
rm $TMP_FILE
echo_it "#### Notes"
echo_it "$RDME_NOTES"
echo_it "$PKGZ_LIST"
echo_it "#### Partition Scheme"
echo_it "$LSBLK"

echo "Done."
